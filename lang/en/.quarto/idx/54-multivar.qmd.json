{"title":"Multivariate mixed models","markdown":{"headingText":"Multivariate mixed models","containsRefs":false,"markdown":"\n## Lecture\n\nAmazing beasties and crazy animals\n\n```{r}\n#| echo: false\n#| out-width: 50%\n#| fig-align: center\n#| fig-cap: Dream pet dragon\nknitr::include_graphics(\"images/fun_dragon.jpg\")\n```\n\nadd a comparison of lrt \n\n\n## Practical\n\nIn this practical, we have collected data on the amazing blue dragon of the East that roam the sky at night.\n\nWe will use two different `r emoji::emoji(\"package\")` to fit more complex models that are not possible with  `lmer()` from `lme4` \n`r emoji::emoji(\"package\")` [@lme4]. We will use:\n\n- `asreml-R` which is a commercial software developed by VSNi [@asreml]. `ASReml` fit models using a maximum likelihood approach, is quite flexible and fast.\n- `MCMCglmm` which is free and open-source and fit model using a Bayesian approach [@MCMCglmm]. It is super flexible and allow to fit a wide diversity of distribution.\n\n\nThe aims of the practical are to learn:\n\n- How to phrase questions of interest in terms of variances and covariances (or derived correlations or regressions);\n- How to incorporate more advanced model structures, such as:\n    - Fixed effects that apply only to a subset of the response traits;\n    - Traits which are measured a different number of times (e.g., repeated measures of behaviour and a single value of breeding success);\n- Hypothesis testing using likelihood ratio tests.\n\n### R packages needed\n\nFirst we load required libraries\n```{r}\n#| label: loadlibs_mm\n#| message: false\n#| results: hide\n#| warning: false\n\nlibrary(lmerTest)\nlibrary(tidyverse)\nlibrary(asreml)\nlibrary(MCMCglmm)\nlibrary(nadiv)\n```\n\n### The blue dragon of the East\n\nFor this practical, we have collected data on the amazing blue dragon of the East that roam the sky at night.\n\n```{r}\n#| echo: false\n#| out-width: 50%\n#| fig-align: center\n#| fig-cap: Blue dragon male\nknitr::include_graphics(\"images/blue_dragon.jpg\")\n```\n\nWe tagged all dragons individually when they hatch from their eggs. Here, we concentrate on female dragon that produce a single clucth of eggs per mating seasons. Adult femlae blue dragons need to explore vast amount of land to find a compatible male. We thus hypothesized that maximum flight speed as well as exploration are key traits to determine fitness. We were able to obtain repeated measures of flying speed and exploration on 80 adult females during one mating season and also measure the number of egg layed at the end of the season. \n\nEach females was capture 4 times during the season and each time we measured the maximum flying speed using a wind tunnel and exploration using a openfield test.\n\nThe data frame has 6 variables:\n\n- ID: Individual identity\n- assay_rep: the repeat number of the behavioural assay\n- max_speed: maximum flying speed\n- exploration:\n- eggs: measure of reproductive succes measured only once per individual\n- body_size: individual body size measured on the day of the test\n\n\n```{r}\ndf_dragons <- read.csv(\"data/dragons.csv\")\nstr(df_dragons)\n```\n\nTo help with convergence of the model, and also help with parameter interpretation, we will first scale our covariates.\n\n```{r}\ndf_dragons <- df_dragons %>%\n  mutate(\n    body_size_sc = scale(body_size),\n    assay_rep_sc = scale(assay_rep, scale = FALSE)\n  )\n```\n\n### Multiple univariate models\n\nWe first use the `lme4` `r emoji::emoji(\"package\")` to determine the proportion of phenotypic variation (adjusted for fixed effects) that is due to differences among individuals, separately for each trait with repeated measures. \n\n#### Flying speed\n\nOur model includes fixed effects of the assay repeat number (centred) and individual body size (centred and scaled to standard deviation units), as we wish to control for any systematic effects of these variables on individual behaviour. Be aware that controlling variables are at your discretion — for example, while we want to characterise among-individual variance in flying speed after controlling for size effects in this study, others may wish to characterise among-individual variance in flying speed without such control. Using techniques shown later in the practical, it would be entirely possible to characterise both among-individual variance in flying speed and in size, and the among-individual covariance between these measurements.\n\n```{r}\n#| fig-cap: Checking assumptions of model lmer_f\nlmer_f <- lmer(max_speed ~ assay_rep_sc + body_size_sc + (1 | ID),\n  data = df_dragons\n)\npar(mfrow = c(1, 3))\nplot(resid(lmer_f, type = \"pearson\") ~ fitted(lmer_f))\nqqnorm(residuals(lmer_f))\nqqline(residuals(lmer_f))\nhist(residuals(lmer_f))\nsummary(lmer_f)\n```\n\nHaving examined diagnostic plots of the model fit, we can check the model summary. We are interested in the random effects section of the lme4 model output (specifically the variance component — note that the standard deviation here is simply the square root of the variance). Evidence for ‘animal personality’ (or ‘consistent among-individual differences in behaviour’) in the literature is largely taken from the repeatability of behaviorual traits: we can compute this repeatability (also known as the intraclass correlation coefficient) by dividing the variance in the trait due to differences among individuals ($V_{ID}$) by the total phenotypic variance after accounting for the fixed effects ($V_{ID} + V_{residual}$ ). \n\n```{r}\n#| results: hide\nrep_flying <- as.data.frame(VarCorr(lmer_f)) %>%\n  select(grp, vcov) %>%\n  spread(grp, vcov) %>%\n  mutate(repeatability = ID / (ID + Residual))\nrep_flying\n```\n\n```{r}\n#| echo: false\n#| purl: false\nknitr::kable(rep_flying,\n  digits = 3,\n  caption = \"Variance components and repeatbility for the maximum\n   flying speed of blue dragons\"\n)\n```\n\nSo we can see that `r round(rep_flying$repeatability * 100, digits = 2)`\\% of the phenotypic variation in boldness (having controlled for body size and assay\nrepeat number) is due to differences among individuals.\n\n#### Exploration\n\n```{r}\n#| fig-cap: Checking assumptions of model lmer_e\nlmer_e <- lmer(exploration ~ assay_rep_sc + body_size_sc + (1 | ID),\n  data = df_dragons\n)\npar(mfrow = c(1, 3))\nplot(resid(lmer_e, type = \"pearson\") ~ fitted(lmer_e))\nqqnorm(residuals(lmer_e))\nqqline(residuals(lmer_e))\nhist(residuals(lmer_e))\nsummary(lmer_e)\n```\n\nSo the model looks good and we can see our estimates for both fixed and random effects. We can now estimate the repeatbility of exploration.\n\n```{r}\n#| results: hide\nrep_expl <- as.data.frame(VarCorr(lmer_e)) %>%\n  select(grp, vcov) %>%\n  spread(grp, vcov) %>%\n  mutate(repeatability = ID / (ID + Residual))\nrep_expl\n```\n\n```{r}\n#| echo: false\n#| purl: false\nknitr::kable(rep_expl,\n  digits = 3,\n  caption = \"Variance components and repeatability for exploration\n   behaviour of blue dragons\"\n)\n```\n\nBoth of traits of interest are repeatable at the among-individual level. So, the remaining question is estimating the relation between these two traits. Are individuals that are consistently faster than average also more exploratory than average (and vice versa)?\n\n#### Correlation using BLUPs\n\nUsing BLUPs to estimate correlations between traits or to further investigate biological associations can lead to spurious results and anticonservative hypothesis tests and narrow confidence intervals. @hadfield_misuse_2010 discuss the problem as well as present some alternative method to avoid the problem using Bayesian methods. However, it is always preferable to use multivariate models when possible.\n\nWe need to create a data frame that contain the BLUPs from both univariate models.\n\n```{r}\ndf_blups_fe <- merge(\n  as.data.frame(ranef(lmer_f)),\n  as.data.frame(ranef(lmer_e)),\n  by = \"grp\"\n) %>%\n  mutate(\n    speed = condval.x,\n    exploration = condval.y\n  )\n```\n\nWe can now test the correlation among-individual between flying speed and exploration.\n\n```{r}\n#| fig-cap: Relation between exploration and flying speed using BLUPs from univariate\n#|   models\n(cor_blups <- with(df_blups_fe, cor.test(speed, exploration)))\nggplot(df_blups_fe, aes(x = exploration, y = speed)) +\n  geom_point() +\n  labs(xlab = \"Exploration (BLUP)\", ylab = \"Flying speed (BLUP)\") +\n  theme_classic()\n```\n\nAs you can see, we get a positive correlation with a very small p-value (P = `r format(cor_blups$p.value, digits = 3)`), indicating that these traits are involved in a behavioural syndrome. While the correlation itself is fairly weak ($r = `r format(cor_blups$estimate, digits = 3)`), it appears to be highly significant, and suggests that individuals that are faster than average also tend to be more exploratory than average.\nHowever, as discussed in @hadfield_misuse_2010 and @houslay_avoiding_2017, using BLUPs in this way leads to anticonservative significance tests. This is because the error inherent in their prediction is not carried forward from the lmer models to the subsequent analysis (in this case, a correlation test).\nTo illustrate this point quickly, below we plot the individual estimates along with their associated standard errors.\n\n```{r}\n#| fig-cap: Relation between exploration and flying speed using BLUPs from univariate\n#|   models including +/- SE as error bars\nggplot(df_blups_fe, aes(x = exploration, y = speed)) +\n  geom_point() +\n  geom_linerange(aes(\n    xmin = exploration - condsd.x,\n    xmax = exploration + condsd.x\n  )) +\n  geom_linerange(aes(\n    ymin = speed - condsd.y,\n    ymax = speed + condsd.y\n  )) +\n  labs(\n    xlab = \"Exploration (BLUP +/- SE)\",\n    ylab = \"Flying speed (BLUP +/- SE)\"\n  ) +\n  theme_classic()\n```\n\n### Multivariate approach\n\n#### Based on ASRemlR\n\nThe correct approach for testing the hypothesised relation between speed and exploration uses both response variables in a two-trait (‘bivariate’) mixed model. This model estimates the among-individual variance for each response variable (and the covariance between them).\nSeparate (co)variances are also fitted for the residual variation.\nThe bivariate model also allows for fixed effects to be fitted on both response variables.\nWe set up our model using the `asreml` function call, with our bivariate response variable being `exploration` and flying `speed` bound together using `cbind`. You will also note that we scale our response variables, meaning that each is centred at their mean value and standardised to units of 1 standard deviation. This is not essential, but simply makes it easier for the model to be fit. Scaling the response variables also aids our understanding of the output, as both flying speed and exploration are now on the same scale.\n\n`asreml` can be a bit specific sometime and random effects should absolutely be `factor` and not `character` or `integer`\n\n```{r}\n#| warning: false\ndf_dragons <- df_dragons %>%\n  mutate(\n    ID = as.factor(ID),\n    speed_sc = scale(max_speed),\n    exploration_sc = scale(exploration)\n  )\n\nasr_us <- asreml(\n  cbind(speed_sc, exploration_sc) ~ trait +\n    trait:assay_rep_sc + trait:body_size_sc,\n  random = ~ ID:us(trait),\n  residual = ~ units:us(trait),\n  data = df_dragons,\n  maxiter = 100\n)\n```\n\nOn the right hand side of our model formula, we use the `trait` keyword to specify that this is a multivariate model — `trait` itself tells the model to give us the intercept for each trait. We then interact `trait` with the fixed effects, `assay_rep_sc` and `body_size_sc`, so that we get estimates for the effect of these variables on each of teh 2 traits.\nThe random effects structure starts with the random effects, where we tell the model to fit an *unstructured* (us) covariance matrix for the grouping variable ID. This means that the variance in exploration due to differences among individuals, the variance in boldness due to differences among individuals, and the covariance between these variances will be estimated.\nNext, we set a structure for the residual variation (`residual`), which is also sometimes known as the *within-individual variation*. As we have repeated measures for both traits at the individual level, we also set an *unstructured* covariance matrix, which estimates the residual variance for each trait and also allows the residuals\nto covary across the two traits.\nFinally, we provide the name of the data frame, and a maximum number of iterations for ASReml to attempt to fit the model.\nAfter the model has been fit by ASReml, we can check the fit using the same type of model diagnostic plots as we use for `lme4`:\n\n```{r}\n#| fig-cap: Checking assumptions of model asr_us\npar(mfrow = c(1, 3))\nplot(residuals(asr_us) ~ fitted(asr_us))\nqqnorm(residuals(asr_us))\nqqline(residuals(asr_us))\nhist(residuals(asr_us))\n```\n\nThe summary part of the ASReml model fit contains a large amount of information, so it is best to look only at certain parts of it at a single time. While we are not particularly interested in the fixed effects for current purposes, you can inspect these using the following code to check whether there were any large effects of `assay repeat` or `body size` on either trait:\n\n```{r}\nsummary(asr_us, coef = TRUE)$coef.fixed\nwa <- wald(asr_us, ssType = \"conditional\", denDF = \"numeric\")\nattr(wa$Wald, \"heading\") <- NULL\nwa\n```\n\nWe can see that there is a separate intercept for both personality traits (no surprise that these are very close to zero, given that we mean-centred and scaled each trait before fitting the model), and an estimate of the effect of assay repeat and body size on both traits. None of these appear to be large effects, so let’s move on to the more interesting parts — the random effects estimates:\n\n```{r}\nsummary(asr_us)$varcomp\n```\n\nIn the above summary table, we have the among-individual (co)variances listed first (starting with ID), then the residual (or within-individual) (co)variances (starting with R). You will notice that the variance estimates here are actually close to the `lme4` repeatability estimates, because our response variables were scaled to phenotypic standard deviations. We can also find the ‘adjusted repeatability’ (i.e., the repeatability conditional on the fixed effects) for each trait by dividing its among-individual variance estimate by the sum\nof its among-individual and residual variances.\nHere, we use the `vpredict` function to estimate the repeatability and its\nstandard error for each trait, conditional on the effects of assay repeat and body size.\nFor this function, we provide the name of the model object, followed by a name that we want to give the estimate being returned, and a formula for the calculation. Each ‘V’ term in the formula refers to a variance component, using its position in the model summary shown above.\n\n```{r}\nvpredict(asr_us, rep_speed ~ V1 / (V1 + V5))\nvpredict(asr_us, rep_expl ~ V3 / (V3 + V7))\n```\n\nWe can also use this function to calculate the estimate and standard error of the correlation from our model (co)variances. We do this by specifying the formula for the correlation:\n\n```{r}\n(cor_fe <- vpredict(asr_us, cor_expl_speed ~ V2 / (sqrt(V1 * V3))))\n```\n\nIn this case, the estimate is similar (here, slightly lower) than our correlation estimate using BLUPs.\nHowever, if we consider confidence intervals as *+/- 1.96 SE* around the estimate, the lower bound of the confidence interval would actually be `r format(cor_fe[1] - cor_fe[2]*1.96, digits = 3)`.\nWith confidence intervals straddling zero, we would conclude that this correlation is likely non-significant.\nAs the use of standard errors in this way is only approximate, we should also test our hypothesis formally using likelihood ratio tests.\n\n##### Hypothesis testing\n\nWe can now test the statistical significance of this correlation directly, by fitting a second model without the among-individual covariance between our two traits, and then using a likelihood ratio test to determine whether the model with the covariance produces a better fit.\nHere, we use the `idh` structure for our random effects. This stands for ‘identity matrix’ (i.e., with 0s on the off-diagonals) with heterogeneous variances (i.e., the variance components for our two response traits are allowed to be different from one another).\nThe rest of the model is identical to the previous version.\n\n```{r}\nasr_idh <- asreml(\n  cbind(speed_sc, exploration_sc) ~ trait +\n    trait:assay_rep_sc + trait:body_size_sc,\n  random = ~ ID:idh(trait),\n  residual = ~ units:us(trait),\n  data = df_dragons,\n  maxiter = 100\n)\n```\n\nThe likelihood ratio test is calculated as twice the difference between model log-likelihoods, on a single degree of freedom (the covariance term):\n```{r}\n(p_biv <- pchisq(2 * (asr_us$loglik - asr_idh$loglik),\n  df = 1,\n  lower.tail = FALSE\n))\n```\n\nIn sharp contrast to the highly-significant P-value given by a correlation test using BLUPs, here we find no evidence for a correlation between flying speed and exploration.\nTo better understand why BLUPs produce an anticonservative p-value in comparison to multivariate models, we should plot the correlation estimates and their confidence intervals. The confidence intervals are taken directly from the cor.test function for BLUPs, and for ASReml they are calculated as 1.96 times the standard error from the `vpredict` function.\n\n```{r}\n#| fig-cap: Correlation estimates (with CI) using 2 different methods\ndf_cor <- data.frame(\n  Method = c(\"ASReml\", \"BLUPs\"),\n  Correlation = c(as.numeric(cor_fe[1]), cor_blups$estimate),\n  low = c(as.numeric(cor_fe[1] - 1.96 * cor_fe[2]), cor_blups$conf.int[1]),\n  high = c(as.numeric(cor_fe[1] + 1.96 * cor_fe[2]), cor_blups$conf.int[2])\n)\nggplot(df_cor, aes(x = Method, y = Correlation)) +\n  geom_point() +\n  geom_linerange(aes(ymin = low, ymax = high)) +\n  ylim(-1, 1) +\n  geom_hline(yintercept = 0, linetype = 2) +\n  theme_classic()\n```\n\nHere we can clearly see that the BLUPs method - having failed to carry through the error around the predictions of individual-level estimates - is anticonservative, with small confidence intervals and a correspondingly small P-value (*P =* `r format(cor_blups$p.value, digits = 3)`). Testing the syndrome directly in a bivariate model that retains all the data, by\ncomparison, enables us to capture the true uncertainty about the estimate of the correlation. This is reflected\nin the larger confidence intervals and, in this case, the non-significant P-value (*P =* `r format(p_biv, digits = 3)`).\n\n<!--\nneed to add the selection aspect with trivariate model with fitness\n-->\n\n##### Conclusions\nTo conclude, then: we found that the correlation between flying speed and exploration tends to be positive among female blue dragon. This correlation is not statistically significant, and thus does not provide strong evidence. However, inappropriate analysis of BLUP extracted from univariate models would lead to a different (erroneous) conclusion. \n\n\n\n#### Using MCMCglmm\n\nIn this section I present the code needed to fit the model and explain only the specific aspect of fittign and evaluating the models with `MCMCglmm`.\n\nTo be completed. with more details\n\nFirst, we need to create a ‘prior’ for our model. We recommend reading up on the use of priors [see the course notes of `MCMCglmm` @MCMCglmm]; briefly, we use a parameter-expanded prior here that should be uninformative for our model. One of the model diagnostic steps that should be used later is to check that the model is robust to multiple prior specifications.\n\n```{r}\nprior_1ex <- list(\n  R = list(V = diag(2), nu = 0.002),\n  G = list(G1 = list(\n    V = diag(2) * 0.02, nu = 3,\n    alpha.mu = rep(0, 2),\n    alpha.V = diag(1000, 2, 2)\n  ))\n)\n```\n\n```{r}\n#| message: false\n#| warning: false\n#| cache: true\nmcmc_us <- MCMCglmm(cbind(speed_sc, exploration_sc) ~ trait - 1 +\n  trait:assay_rep_sc +\n  trait:body_size_sc,\nrandom = ~ us(trait):ID,\nrcov = ~ us(trait):units,\nfamily = c(\"gaussian\", \"gaussian\"),\nprior = prior_1ex,\nnitt = 420000,\nburnin = 20000,\nthin = 100,\nverbose = FALSE,\ndata = df_dragons\n)\n```\n\n```{r}\n#| fig.cap: \"MCMC trace and Posterior distribution of the (co)variance estimates of model mcmc_us\"\n#| warning: false\nomar <- par()\npar(mar = c(4, 2, 1.5, 2))\nplot(mcmc_us$VCV[, c(1, 2, 4)])\nplot(mcmc_us$VCV[, c(5, 6, 8)])\npar(omar)\n```\n\n```{r}\nsummary(mcmc_us)\n```\n\n```{r}\n#| fig-cap: Posterior trace and distribution of the repeatability in flying speed\nmcmc_prop_f <- mcmc_us$VCV[, 1] /\n  (mcmc_us$VCV[, 1] + mcmc_us$VCV[, 5])\nplot(mcmc_prop_f)\n```\n\n```{r}\nposterior.mode(mcmc_prop_f)\nHPDinterval(mcmc_prop_f)\n```\n\n```{r}\n#| fig-cap: Posterior trace and distribution of the repeatbility of exploration\nmcmc_prop_e <- mcmc_us$VCV[, 4] /\n  (mcmc_us$VCV[, 4] + mcmc_us$VCV[, 8])\nplot(mcmc_prop_e)\nposterior.mode(mcmc_prop_e)\nHPDinterval(mcmc_prop_e)\n```\n\n```{r}\n#| fig-cap: Posterior trace and distribution of the correlation between flying speed\n#|   and exploration\nmcmc_cor_fe <- mcmc_us$VCV[, 2] /\n  sqrt(mcmc_us$VCV[, 1] * mcmc_us$VCV[, 4])\nplot(mcmc_cor_fe)\nposterior.mode(mcmc_cor_fe)\nHPDinterval(mcmc_cor_fe)\n```\n\n```{r}\n#| fig-cap: Correlation estimates (with CI) using 3 different methods\ndf_cor[3, 1] <- \"MCMCglmm\"\ndf_cor[3, -1] <- c(posterior.mode(mcmc_cor_fe), HPDinterval(mcmc_cor_fe))\nrownames(df_cor) <- NULL\n\nggplot(df_cor, aes(x = Method, y = Correlation)) +\n  geom_point() +\n  geom_linerange(aes(ymin = low, ymax = high)) +\n  ylim(-1, 1) +\n  geom_hline(yintercept = 0, linetype = 2) +\n  theme_classic()\n```\n```{r}\n#| echo: false\n#| purl: false\nknitr::kable(df_cor,\n  digits = 3,\n  caption =\n    \"Correlation (with 95% intervals) between flying speed\n     and exploration estimated with 3 different methods\"\n)\n```\n### Happy multivariate models\n\n```{r}\n#| echo: false\n#| out-width: 50%\n#| fig-align: center\n#| fig-cap: A female blue dragon of the West\nknitr::include_graphics(\"images/blue_dragon.jpg\")\n```\n\n\n\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","from":"markdown+emoji","number-sections":true,"output-file":"54-multivar.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en-CA","fig-responsive":true,"quarto-version":"1.5.45","version":"0.6.0","year":2024,"bibliography":["biblio/book.bib","biblio/grateful-refs.bib"],"biblio-style":"apalike","csl":"biblio/ecology.csl","params":{"echo_sol":true,"longrun":false,"html_pdf":true},"cit-title":"Do what you think is interesting,  \ndo something that you think is fun and worthwhile,  \nbecause otherwise you won’t do it well anyway.\n","cit-author":"Brian W. Kernighan","theme":{"light":"cosmo","dark":["cosmo","css/theme-dark.scss"]},"author-meta":"Julien Martin"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"lualatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","from":"markdown+emoji","number-sections":true,"output-file":"54-multivar.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":false,"version":"0.6.0","year":2024,"bibliography":["biblio/book.bib","biblio/grateful-refs.bib"],"biblio-style":"apalike","csl":"biblio/ecology.csl","params":{"echo_sol":true,"longrun":false,"html_pdf":true},"lang":"en-CA","cit-title":"Do what you think is interesting,  \ndo something that you think is fun and worthwhile,  \nbecause otherwise you won’t do it well anyway.\n","cit-author":"Brian W. Kernighan","documentclass":"scrreprt","classoption":["chapterprefix=true","headings=big","twoside=semi"],"papersize":"letter","fontsize":"11pt","geometry":["top=2cm","bottom=2cm","left=2cm","right=2cm","footskip=1cm"],"colorlinks":true,"linestretch":1.5,"template-partials":["latex/before-title.tex","latex/before-body.tex"]},"extensions":{"book":{"selfContainedOutput":true}}},"epub":{"identifier":{"display-name":"ePub","target-format":"epub","base-format":"epub"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"epub","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":false,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"default-image-extension":"png","html-math-method":"mathml","to":"epub","from":"markdown+emoji","toc":true,"output-file":"54-multivar.epub"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"version":"0.6.0","year":2024,"bibliography":["biblio/book.bib","biblio/grateful-refs.bib"],"biblio-style":"apalike","csl":"biblio/ecology.csl","params":{"echo_sol":true,"longrun":false,"html_pdf":true},"lang":"en-CA","cit-title":"Do what you think is interesting,  \ndo something that you think is fun and worthwhile,  \nbecause otherwise you won’t do it well anyway.\n","cit-author":"Brian W. Kernighan","dev":"svglite","stylesheet":"css/epub.css"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf","epub"]}