{"title":"Random regression and character state approaches","markdown":{"headingText":"Random regression and character state approaches","containsRefs":false,"markdown":"\n## Lecture\n\nAnd here there would be dragons\n\n```{r}\n#| echo: false\n#| out-width: 50%\n#| fig-align: center\n#| fig-cap: Dream pet dragon\nknitr::include_graphics(\"images/fun_dragon.jpg\")\n```\n\n## Practical\n\nIn this practical, we will revisit our analysis on unicorn aggressivity.\nHonestly, we can use any other data with repeated measures for this exercise\nbut I just `r emoji::emoji(\"heart\")` unicorns.\n\n### R packages needed\n\nFirst we load required libraries\n```{r}\n#| message: false\n#| results: hide\n#| warning: false\nlibrary(lme4)\nlibrary(tidyverse)\nlibrary(broom.mixed)\nlibrary(asreml)\nlibrary(MCMCglmm)\nlibrary(bayesplot)\nlibrary(patchwork)\n```\n\n### Refresher on unicorn aggression\n\nIn the previous, practical on linear mixed models, we simply explored the differences among individuals in their mean aggression (Intercept), but we assumed that the response to the change in aggression with the opponent size (i.e. plasticity) was the same for all individuals. However, this plastic responses can also vary amon individuals. This is called IxE, or individual by environment interaction. To test if individuals differ in their plasticity we can use a random regression, whcih is simply a mixed-model where we fit both a random intercept and a random slope effect.\n\nFollowing analysis from the previous pratical, our model of interest using scaled covariate was:\n\n```\naggression ~ opp_size + body_size_sc + assay_rep_sc + block\n              + (1 | ID)\n```\n\nWe should start by loading the data and refitting the model using `lmer()`.\n\n```{r}\nunicorns <- read.csv(\"data/unicorns_aggression.csv\")\nunicorns <- unicorns %>%\n  mutate(\n    body_size_sc = scale(body_size),\n    assay_rep_sc = scale(assay_rep, scale = FALSE)\n  )\n\nm_mer <- lmer(\n    aggression ~ opp_size + body_size_sc + assay_rep_sc + block\n      + (1 | ID),\n    data = unicorns\n)\nsummary(m_mer)\n```\n\nWe can now plot the predictions for each of our observations and plot for the observed and the fitted data for each individuals. Todo so we will use the `augment()` function from the `r emoji::emoji(\"package\")` `broom.mixed`.\n\nBelow, we plot the raw data for each individual in one panel, with the fitted slopes in a second panel. Because\nwe have 2 blocks of data, and block is fitted as a fixed effect, for ease of presentation we need to either  select only 1 block for representation, take teh avaerage over the block effect or do a more complex graph with the two blocks. Here I have selected only one of the blocks for this plot\n\n```{r}\n#| fig-cap: Predicted (from m_mer) and observed value of aggression as a function of\n#|   opponent size in unicorns\npred_m_mer <- augment(m_mer) %>%\n  select(ID, block, opp_size, .fitted, aggression) %>%\n  filter(block == -0.5) %>%\n  gather(\n    type, aggression,\n    `.fitted`:aggression\n  )\nggplot(pred_m_mer, aes(x = opp_size, y = aggression, group = ID)) +\n  geom_line(alpha = 0.3) +\n  theme_classic() +\n  facet_grid(. ~ type)\n```\n\nThis illustrates the importance of using model predictions to see whether the model actually fits the individual-level data well or not — while the diagnostic plots looked fine, and the model captures mean plasticity, here we can see that the model really doesn’t fit the actual data very well at all. \n\n<!--The code below provides a different (and slightly more in-depth) look at this same combination of fitted slope / real data, and indicates that the fitted slopes systematically under- and over-estimate plasticity\nin aggression at the individual level (figure not shown since it has `r length(unique(unicorns$ID))` panels).\n\nneed to figure out the code\n-->\n\n### Random regression\n\n#### with `lme4`\n\n\n```{r}\nrr_mer <- lmer(\n  aggression ~ opp_size + body_size_sc + assay_rep_sc + block\n  + (1 + opp_size | ID),\n  data = unicorns\n)\n```\n\n```{r}\npred_rr_mer <- augment(rr_mer) %>%\n  select(ID, block, opp_size, .fitted, aggression) %>%\n  filter(block == -0.5) %>%\n  gather(type,aggression, `.fitted`:aggression)\nggplot(pred_rr_mer, aes(x = opp_size, y = aggression, group = ID)) +\n  geom_line(alpha = 0.3) +\n  theme_classic() +\n  facet_grid(. ~ type)\n```\n\n\nWe can test the improvement of the model fit using the overloaded anova function in R to perform a likelihood ratio test (LRT):\n\n```{r}\n#| eval: false\nanova(rr_mer, m_mer, refit = FALSE)\n```\n\n```{r}\n#| echo: false\nknitr::kable(anova(rr_mer, m_mer, refit = FALSE))\n```\n\nWe can see here that the LRT uses a chi-square test with 2 degrees of freedom, and indicates that the random slopes model shows a statistically significant improvement in model fit. The 2df are because there are two additional (co)variance terms estimated in the random regression model: a variance term for individual slopes, and the covariance (or correlation) between the slopes and intercepts. Let’s look at those values, and also the fixed effects parameters, via the model summary:\n\n```{r}\nsummary(rr_mer)\n```\n\n\n#### with `asreml`\n\n```{r}\nunicorns <- unicorns %>%\n  mutate( ID = as.factor(ID))\nrr_asr <- asreml(\n  aggression ~ opp_size + body_size_sc + assay_rep_sc + block,\n  random = ~str(~ ID + ID:opp_size, ~us(2):id(ID)),\n  residual = ~ units,\n  data = unicorns,\n  maxiter = 200\n)\n```\n\n```{r}\nplot(rr_asr)\n```\n```{r}\nsummary(rr_asr, coef = TRUE)$coef.fixed\nwa <- wald(rr_asr, ssType = \"conditional\", denDF = \"numeric\")\nattr(wa$Wald, \"heading\") <- NULL\nwa\n```\n\n```{r}\nsummary(rr_asr)$varcomp\n```\n\n```{r}\nrio_asr <- asreml(\n  aggression ~ opp_size + body_size_sc + assay_rep_sc + block,\n  random = ~ ID,\n  residual = ~units,\n  data = unicorns,\n  maxiter = 200\n)\n```\n\n```{r}\npchisq(2 * (rr_asr$loglik - rio_asr$loglik), 2,\n  lower.tail = FALSE\n)\n```\n\n```{r}\nvpredict(rr_asr, cor_is ~ V2 / (sqrt(V1) * sqrt(V3)))\n```\n\n```{r}\npred_rr_asr <- as.data.frame(predict(rr_asr,\n  classify = \"opp_size:ID\",\n  levels = list(\n    \"opp_size\" =\n      c(opp_size = -1:1)\n  )\n)$pvals)\np_rr <- ggplot(pred_rr_asr, aes(\n  x = opp_size,\n  y = predicted.value,\n  group = ID\n)) +\n  geom_line(alpha = 0.2) +\n  scale_x_continuous(breaks = c(-1, 0, 1)) +\n  labs(\n    x = \"Opponent size (SDU)\",\n    y = \"Aggression\"\n  ) +\n  theme_classic()\np_rr\n```\n\n\n#### with `MCMCglmm`\n\n```{r}\n#| cache: true\nprior_RR <- list(\n  R = list(V = 1, nu = 0.002),\n  G = list(\n    G1 = list(V = diag(2)*0.02, nu = 3,\nalpha.mu = rep(0, 2),\nalpha.V= diag(1000, 2, 2))))\nrr_mcmc <- MCMCglmm(\n  aggression ~ opp_size + assay_rep_sc + body_size_sc + block,\n  random = ~ us(1 + opp_size):ID,\n  rcov = ~ units,\nfamily = \"gaussian\",\nprior = prior_RR,\nnitt=750000,\nburnin=50000,\nthin=350,\nverbose = FALSE,\ndata = unicorns,\npr = TRUE,\nsaveX = TRUE, saveZ = TRUE)\n```\n\n\n```{r}\nomar <- par()\npar(mar = c(4, 2, 1.5, 2))\nplot(rr_mcmc$VCV)\npar(omar)\n```\n\n```{r}\nposterior.mode(rr_mcmc$VCV[, \"opp_size:opp_size.ID\"]) # mean\nHPDinterval(rr_mcmc$VCV[, \"opp_size:opp_size.ID\"])\n```\n\n```{r}\nrr_cor_mcmc <- rr_mcmc$VCV[, \"opp_size:(Intercept).ID\"] /\n  (sqrt(rr_mcmc$VCV[, \"(Intercept):(Intercept).ID\"]) *\n    sqrt(rr_mcmc$VCV[, \"opp_size:opp_size.ID\"]))\nposterior.mode(rr_cor_mcmc)\nHPDinterval(rr_cor_mcmc)\n```\n\n```{r}\ndf_rand <- cbind(unicorns,\n  rr_fit = predict(rr_mcmc, marginal = NULL)\n) %>%\n  select(ID, opp_size, rr_fit, aggression) %>%\n  group_by(ID, opp_size) %>%\n  summarise(\n    rr_fit = mean(rr_fit),\n    aggression = mean(aggression)\n  ) %>%\n  gather(\n    Type, Value,\n    rr_fit:aggression\n  )\n# Plot separate panels for individual lines of each type\nggplot(df_rand, aes(x = opp_size, y = Value, group = ID)) +\n  geom_line(alpha = 0.3) +\n  scale_x_continuous(breaks = c(-1, 0, 1)) +\n  theme_classic() +\n  facet_grid(. ~ Type)\n```\n\n```{r}\n#| echo: false\n#| purl: false\ndf_var <-data.frame(Method = c(\"lmer\", \"asreml\", \"MCMCglmm\"), v_int = NA, cov = NA, v_sl = NA, v_r = NA)\nv_rr_mer <- as.data.frame(VarCorr(rr_mer))\ndf_var[1, 2:5] <- v_rr_mer$vcov[c(1,3,2,4)]\ndf_var[2, 2:5] <- summary(rr_asr)$varcomp$component\ndf_var[3, 2:5] <- posterior.mode(rr_mcmc$VCV[,-2])\nknitr::kable(df_var,\n  caption = \"Variance estimated from random regression models using 3 different softwares\")\n```\n\n### Character-State approach\n\nNeed to pivot to a wider format\n\n```{r}\nunicorns_cs <- unicorns %>%\n  select(ID, body_size, assay_rep, block, aggression, opp_size) %>%\n  mutate(\n    opp_size = recode(as.character(opp_size), \"-1\" = \"s\", \"0\" = \"m\", \"1\" = \"l\")\n  ) %>%\n  dplyr::rename(agg = aggression) %>%\n  pivot_wider(names_from = opp_size, values_from = c(agg, assay_rep)) %>%\n  mutate(\n    body_size_sc = scale(body_size),\n    opp_order = as.factor(paste(assay_rep_s, assay_rep_m, assay_rep_l, sep = \"_\"))\n  )\nstr(unicorns_cs)\nhead(unicorns_cs)\n```\n\n```{r}\ncs_asr <- asreml(\n  cbind(agg_s, agg_m, agg_l) ~ trait + trait:body_size_sc +\n    trait:block +\n    trait:opp_order,\n  random =~ ID:us(trait),\n  residual =~ units:us(trait),\n  data = unicorns_cs,\n  maxiter = 200\n)\n\nplot(residuals(cs_asr) ~ fitted(cs_asr))\nqqnorm(residuals(cs_asr))\nqqline(residuals(cs_asr))\nhist(residuals(cs_asr))\n```\n\n```{r}\nsummary(cs_asr, all = T)$coef.fixed\nwa <- wald(cs_asr, ssType = \"conditional\", denDF = \"numeric\")\nattr(wa$Wald, \"heading\") <- NULL\nwa\n```\n\n```{r}\nsummary(cs_asr)$varcomp[, c(\"component\", \"std.error\")]\n```\n\n```{r}\ncs_idh_asr <- asreml(\n  cbind(agg_s, agg_m, agg_l) ~ trait + trait:body_size_sc +\n    trait:block +\n    trait:opp_order,\n  random = ~ ID:idh(trait),\n  residual = ~ units:us(trait),\n  data = unicorns_cs,\n  maxiter = 200\n)\n```\n\n```{r}\npchisq(2 * (cs_asr$loglik - cs_idh_asr$loglik), 3,\n  lower.tail = FALSE\n)\n```\n\n```{r}\nvpredict(cs_asr, cor_S_M ~ V2 / (sqrt(V1) * sqrt(V3)))\nvpredict(cs_asr, cor_M_L ~ V5 / (sqrt(V3) * sqrt(V6)))\nvpredict(cs_asr, cor_S_L ~ V4 / (sqrt(V1) * sqrt(V6)))\n```\n\n```{r}\nvpredict(cs_asr, prop_S ~ V1 / (V1 + V8))\nvpredict(cs_asr, prop_M ~ V3 / (V3 + V10))\nvpredict(cs_asr, prop_L ~ V6 / (V6 + V13))\n```\n\n```{r}\ninit_CS_cor1_tri <- c(\n  0.999,\n  0.999, 0.999,\n  1, 1, 1\n)\nnames(init_CS_cor1_tri) <- c(\n  \"F\",\n  \"F\", \"F\",\n  \"U\", \"U\", \"U\"\n)\ncs_asr_cor1_tri <- asreml(\n  cbind(agg_s, agg_m, agg_l) ~ trait + trait:body_size_sc +\n    trait:block +\n    trait:opp_order,\n  random = ~ ID:corgh(trait, init = init_CS_cor1_tri),\nresidual = ~ units:us(trait),\ndata = unicorns_cs,\nmaxiter = 500\n)\npchisq(2 * (cs_asr$loglik - cs_asr_cor1_tri$loglik),\n  3,\n  lower.tail = FALSE\n)\n```\n\n```{r}\ndf_CS_pred <- as.data.frame(predict(cs_asr,\n  classify = \"trait:ID\"\n)$pvals)\n# Add numeric variable for easier plotting\n# of opponent size\ndf_CS_pred <- df_CS_pred %>%\n  mutate(sizeNum = ifelse(trait == \"agg_s\", -1,\n    ifelse(trait == \"agg_m\", 0, 1)\n  ))\np_cs <- ggplot(df_CS_pred, aes(\n  x = sizeNum,\n  y = predicted.value,\n  group = ID\n)) +\n  geom_line(alpha = 0.2) +\n  scale_x_continuous(breaks = c(-1, 0, 1)) +\n  labs(\n    x = \"Opponent size (SDU)\",\n    y = \"Aggression\"\n  ) +\n  theme_classic()\np_cs\n```\n\n```{r}\nunicorns <- arrange(unicorns, opp_size, by_group = ID)\np_obs <- ggplot(unicorns[unicorns$block==-0.5,], aes(x = opp_size, y = aggression, group = ID)) +\n  geom_line(alpha = 0.3) +\n  scale_x_continuous(breaks = c(-1, 0, 1)) +\n  labs(\n    x = \"Opponent size (SDU)\",\n    y = \"Aggression\"\n  ) +\n  ggtitle(\"Observed\") +\n  ylim(5.9, 12) +\n  theme_classic()\n\np_rr <- p_rr + ggtitle(\"Random regression\") + ylim(5.9, 12)\np_cs <- p_cs + ggtitle(\"Character-State\") + ylim(5.9, 12)\np_obs + p_rr + p_cs\n```\n\n### From random regression to character-state\n\n```{r}\nvar_mat_asr <- function(model, var_names, pos){\n  size <- length(var_names)\n  v_out <- matrix(NA, ncol = size, nrow = size)\n  rownames(v_out) <- var_names\n  colnames(v_out) <- var_names\n  v_out[upper.tri(v_out, diag = TRUE)] <- summary(model)$varcomp[pos, 1]\n  v_out <- forceSymmetric(v_out, uplo = \"U\")\n  as.matrix(v_out)\n}\nv_id_rr <- var_mat_asr(rr_asr, c(\"v_int\", \"v_sl\"), 1:3)\nknitr::kable(v_id_rr, digits = 3)\n```\n```{r}\nv_id_cs <- var_mat_asr(cs_asr, c(\"v_s\", \"v_m\", \"v_l\"), 1:6)\nknitr::kable(v_id_cs, digits = 3)\n```\n\nWe also need to make a second matrix, let's call it **Q** (no particular reason, pick something else if you want). This is going to contain the values needed to turn an individual's intercept (mean) and slope (plasticity) deviations into estimates of environment-specific individual merit in a character state model.\n\nWhat do we mean by this? Well if an individual i has an intercept deviation of ID~int(i)~ and a slope deviation of ID~slp(i)~ for a given value of the environment  `opp_size` we might be interested in:\n\nID~i~ = (1 x ID~int(i)~) + (`opp_size` x ID~slp(i)~)\n\nWe want to look at character states representing the three observed values of `opp_size` here so\n\n```{r}\nQ <- as.matrix(cbind(c(1, 1, 1),\n                    c(-1, 0, 1)))\n```\n\nThen we can generate our among-individual covariance matrix environment specific aggresiveness, which we can call **ID_cs_rr** by matrix multiplication:\n\n```{r}\nID_cs_rr<- Q %*% v_id_rr %*%t(Q)    #where t(Q) is the transpose of Q\n                               #and %*% is matrix multiplication\n\nID_cs_rr  #rows and columns correspond to aggressiveness at opp_size=-1,0,1 in that order\n\n\ncov2cor(ID_cs_rr)   #Converting to a correlation scale\ncov2cor(v_id_cs)\n```\n\n\n### Conclusions\n\n\n### Happy multivariate models\n\n```{r}\n#| echo: false\n#| out-width: 50%\n#| fig-align: center\n#| fig-cap: A female blue dragon of the West\nknitr::include_graphics(\"images/blue_dragon.jpg\")\n```\n\n\n\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","from":"markdown+emoji","number-sections":true,"output-file":"53-randreg.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en-CA","fig-responsive":true,"quarto-version":"1.5.45","version":"0.6.0","year":2024,"bibliography":["biblio/book.bib","biblio/grateful-refs.bib"],"biblio-style":"apalike","csl":"biblio/ecology.csl","params":{"echo_sol":true,"longrun":false,"html_pdf":true},"cit-title":"Do what you think is interesting,  \ndo something that you think is fun and worthwhile,  \nbecause otherwise you won’t do it well anyway.\n","cit-author":"Brian W. Kernighan","theme":{"light":"cosmo","dark":["cosmo","css/theme-dark.scss"]},"author-meta":"Julien Martin"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"lualatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","from":"markdown+emoji","number-sections":true,"output-file":"53-randreg.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":false,"version":"0.6.0","year":2024,"bibliography":["biblio/book.bib","biblio/grateful-refs.bib"],"biblio-style":"apalike","csl":"biblio/ecology.csl","params":{"echo_sol":true,"longrun":false,"html_pdf":true},"lang":"en-CA","cit-title":"Do what you think is interesting,  \ndo something that you think is fun and worthwhile,  \nbecause otherwise you won’t do it well anyway.\n","cit-author":"Brian W. Kernighan","documentclass":"scrreprt","classoption":["chapterprefix=true","headings=big","twoside=semi"],"papersize":"letter","fontsize":"11pt","geometry":["top=2cm","bottom=2cm","left=2cm","right=2cm","footskip=1cm"],"colorlinks":true,"linestretch":1.5,"template-partials":["latex/before-title.tex","latex/before-body.tex"]},"extensions":{"book":{"selfContainedOutput":true}}},"epub":{"identifier":{"display-name":"ePub","target-format":"epub","base-format":"epub"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"epub","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":false,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"default-image-extension":"png","html-math-method":"mathml","to":"epub","from":"markdown+emoji","toc":true,"output-file":"53-randreg.epub"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"version":"0.6.0","year":2024,"bibliography":["biblio/book.bib","biblio/grateful-refs.bib"],"biblio-style":"apalike","csl":"biblio/ecology.csl","params":{"echo_sol":true,"longrun":false,"html_pdf":true},"lang":"en-CA","cit-title":"Do what you think is interesting,  \ndo something that you think is fun and worthwhile,  \nbecause otherwise you won’t do it well anyway.\n","cit-author":"Brian W. Kernighan","dev":"svglite","stylesheet":"css/epub.css"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf","epub"]}