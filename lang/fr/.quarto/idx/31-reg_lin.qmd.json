{"title":"Corrélation et régression linéaire simple","markdown":{"headingText":"Corrélation et régression linéaire simple","containsRefs":false,"markdown":"<!-- # (PART) Modèle univarié {-} -->\n\n\nAprès avoir complété cet exercice de laboratoire, vous devriez être en mesure de :\n\n* Utiliser R pour produire un diagramme de dispersion pour illus-\ntrer la relation entre deux variables avec trace lowess\n* Utiliser R pour faire des transformations simples\n* Utiliser R pour calculer le coefficient de corrélation de Pearson entre deux variables et en évaluer sa signification statistique\n* Utiliser R pour calculer la corrélation de rang entre des paires de variables avec le r de Spearman et le tau de Kendall\n* Utiliser R pour évaluer la signification de corrélations dans une matrice de corrélation en utilisant les probabilités ajustées par la méthode de Bonferroni.\n* Utiliser R pour faire une régression linéaire simple.\n* Utiliser R pour évaluer si un ensemble de données remplit les conditions d'application d'une analyse de régression simple.\n* Quantifier la taille de l’effet d’une régression simple et effectuer une analyse de puissance avec G\\*Power.\n\n## Extensions R et données requises pour le labo {#set-lm}\nCe laboratoire nécessite:\n\n* les paquets R:\n  * car\n  * lmtest\n  * boot\n  * pwr\n  * ggplot\n* les fichiers de données\n  * sturgeon.csv\n\nIl ne faut pas oublier de charge les extensions avec `library()` et de les installer au besoin avec `install.packages()`\nPour les données, il faut les lire et les assigner à un objet R.\n\n```{r}\n#| label: setup-3\n#| warning: false\n#| message: false\nlibrary(car)\nlibrary(lmtest)\nlibrary(boot)\nlibrary(ggplot2)\nlibrary(pwr)\nlibrary(performance)\n\nsturgeon <- read.csv(\"data/sturgeon.csv\")\n```\n\n::: {.callout-note}\nNotez que la ligne de code pour lire les données considère que le fichier de données se trouve dans un dossier `data` au sein de votre répertoire de travail. Si ce n'est pas le cas veuillez ajuster la ligne de commande.\n:::\n\n\n## Diagrammes de dispersion\nLes analyses de corrélation et de régression devraient toujours commencer par un examen des données.C'est une étape critique qui sert à évaluer si ce type d'analyse est approprié pour un ensemble de données.\nSupposons que nous sommes intéressés à évaluer si la longueur d'esturgeons mâles dans la région de *The Pas* covarie avec leur poids.\nPour répondre à cette question, regardons d'abord la corrélation entre\nla longueur et le poids.\nSouvenez-vous qu'une des conditions d'application de l'analyse de\ncorrélation est que la relation entre les deux variables est linéaire. Pour\névaluer cela, commençons par faire un diagramme de dispersion.\n\n- Les données sur les esturgeons son disponibles dans le fichier `sturgeon.csv`.\nAprès avoir chargé les données dnas un objet `sturgeon`, faites un diagramme de dispersion avec une droite de régression et une courbe LOWESS de la longueur en fonction du poids.\n\n```{r}\n#| label: stur-1\nsturgeon <- read.csv(\"data/sturgeon.csv\")\nstr(sturgeon)\n```\n\n```{r}\n#| label: stur-2\n#| warning: false\n#| message: false\n#| fig-cap: Graphique du poids en fonction de la longueur des esturgeons\nmygraph <- ggplot(\n  data = sturgeon[!is.na(sturgeon$rdwght), ], # source of data\n  aes(x = fklngth, y = rdwght)\n)\n# plot data points, regression, loess trace\nmygraph <- mygraph +\n  stat_smooth(method = lm, se = FALSE, color = \"green\") + # add linear regression, but no SE shading\n  stat_smooth(color = \"red\", se = FALSE) + # add loess\n  geom_point() # add data points\n\nmygraph # display graph\n```\n\n<!-- (notez ici la gymnastique requise pour éliminer les données\nmanquantes qui posent problème pour obtenir la trace loess). -->\n- Est-ce que la dispersion des points suggère une bonne corrélation entre les deux variables?\nEst-ce que la relation semble linéaire?\n\nCe graphique suggère une tendance plus curvilinéaire que linéaire.\nMalgré tout, il semble y avoir une forte corrélation entre les deux variables.\n\n- Refaites le diagramme de dispersion avec des axes logarithmiques.\n\n```{r}\n#| label: stur-log\n#| warning: false\n#| message: false\n#| fig-cap: Graphique poids-longueur avec une échelle log\n# apply log transformation on defined graph\nmygraph + scale_x_log10() + scale_y_log10()\n```\n\nComparez les diagrammes de dispersion avant et après transformation (Figures \\@ref(fig:stur-2) et \\@ref(fig:stur-log)). Comme l’analyse de corrélation présuppose une relation linéaire entre les variables, on devrait donc privilégier l’analyse sur les données log-transformées.\n\n## Transformations et le coefficient de corrélation\nUne autre condition préalable à l'analyse de corrélation est que les deux variables concernées suivent une distribution normale bidimensionnelle.\nOn peut aisément vérifier la normalité de chacune des 2 variables séparément tel que décrit dans le laboratoire précédent.\nSi les deux variables sont normalement distribuées, on présume généralement qu'elles suivent une distribution normale bidimensionnelle lorsqu’analysées simultanément (notez que ce n'est pas toujours le cas cependant).\n\n- Examinez la distribution des quatre variables (les deux variables originales et les variables transformées). Que concluez-vous de l'inspection visuelle de ces graphiques ?\n\nLes figures ci-dessous sont les diagrammes de probabilité (`qqplot()`).\nLe code pour produire des graphiques multiples sur une page, comme\non voit ci-dessous, est:\n\n```{r}\n#| label: stur-4hist\npar(mfrow = c(2, 2)) # divise le graphique en 4 sections\nqqnorm(sturgeon$fklngth, ylab = \"fklngth\")\nqqline(sturgeon$fklngth)\nqqnorm(log10(sturgeon$fklngth), ylab = \"log10(fklngth)\")\nqqline(log10(sturgeon$fklngth))\nqqnorm(sturgeon$rdwght, ylab = \"rdwght\")\nqqline(sturgeon$rdwght)\nqqnorm(log10(sturgeon$rdwght), ylab = \"log10(rdwgth)\")\nqqline(log10(sturgeon$rdwght))\npar(mfrow = c(1, 1)) # redéfinie la zone de graphique par défaut\n```\n\nIl n’y a pas grand-chose à redire: aucune des distributions n’est\nparfaitement normale, mais les déviations semblent mineures.\n\n\n- Générez une matrice de graphiques de dispersion améliorés en utilisant la commande `scatterplotMatrix` de la librairie `car`.\n\n```{r}\n#| label: stur-scatmat\nscatterplotMatrix(\n  ~ fklngth + log10(fklngth) + rdwght + log10(rdwght),\n  data = sturgeon,\n  smooth = TRUE, diagonal = \"density\"\n)\n```\n\n- Ensuite, calculez le coefficient de corrélation de Pearson entre chaque paire (variables originales et logtransformées) en utilisant la commande `cor()`.\nAvant de commencer, on va cependant ajouter les variables transformées au tableau de données sturgeon:\n\n```{r}\n#| label: stur-newvar\nsturgeon$lfklngth <- with(sturgeon, log10(fklngth))\nsturgeon$lrdwght <- log10(sturgeon$rdwght)\n```\n\nVous pouvez ensuite obtenir la matrice de corrélation par:\n```{r}\n#| label: sturmat\n#| eval: false\ncor(sturgeon[, c(\"fklngth\", \"lfklngth\", \"lrdwght\", \"rdwght\")], use = \"complete.obs\")\n```\n\nFréquemment, il y a des données manquantes dans un échantillon.\nEn choisissant `use=\"complete.obs\"`, toutes les lignes du fichier pour lesquelles les variables ne sont pas toutes mesurées sont éliminées.\nDans ce cas, toutes les corrélations seront calculées avec le même nombre de cas.\nPar contre, en utilisant `use=\"pairwise.complete.obs\"`,\nR élimine une observation que lorsqu'un des deux membres de la paire a une valeur manquante.\nDans ce cas, si les données manquantes pour différentes variables se retrouvent dans un groupe différent d'observation, les corrélations ne seront pas nécessairement calculées sur le même nombre de cas ni sur le même sous-ensemble de cas.\nEn général, vous devriez utiliser l'option `use=\"complete.obs\"` à moins que vous ayez un très grand nombre de données manquantes et que cette façon de procéder élimine la plus grande partie de vos\nobservations.\n\nPourquoi la corrélation entre les variables originales est-elle la plus faible des trois ?\n\n```{r}\n#| label: sturmat-eval\ncor(sturgeon[, c(\"fklngth\", \"lfklngth\", \"lrdwght\", \"rdwght\")], use = \"complete.obs\")\n```\n\nIl y a plusieurs choses à noter ici.\n\n* Premièrement, la corrélation entre la longueur à la fourche et le poids rond est élevée, peu importe la transformation: les poissons lourds ont tendance à être longs.\n* Deuxièmement, la corrélation est plus forte pour les données\ntransformées que pour les données brutes.\n\n__Pourquoi?__ Parce que le coefficient de corrélation est inversement proportionnel au bruit autour de la relation linéaire.\nSi la relation est curvilinéaire (comme dans le cas des données non transformées), le bruit est plus grand que si la relation est parfaitement linéaire.\nPar conséquent, la corrélation est plus faible.\n\n## Matrices de corrélations et correction de Bonferroni\n\nUne pratique courante est d'examiner une matrice de corrélation à la recherche des associations significatives.\nComme exemple, essayons de tester si la corrélation entre lfklngth et rdwght est significative (c’est le plus faible coefficient de corrélation de cette matrice).\n\n- Estimer la correlation entre la longueur (fklngth) et le poids (rdwght) des esturgeons:\n\n```{r}\n#| label: sturcor-2\ncor.test(\n  sturgeon$lfklngth, sturgeon$rdwght,\n  alternative = \"two.sided\",\n  method = \"pearson\"\n)\n```\n\nOn voit ici que la corrélation est hautement significative ($p < 2.2e-16$),ce qui n’est pas surprenant étant donné la valeur du coefficient de corrélation (0.8756).\nIl est important de réaliser que si une matrice contient un grand nombre de corrélations, il n'est pas surprenant d'en trouver au moins une qui soit “significative”.\nEn effet, on s'attend à en trouver 5% en moyenne lorsqu'il n'y a en fait aucune corrélation entre les paires de moyennes.\nUne façon de corriger pour cette tendance est d'ajuster le niveau $\\alpha$ critique auquel on attribue une signification statistique en divisant $\\alpha$ par le nombre $k$ de corrélations qui sont examinées : $\\alpha' =\n\\alpha / k$ (ajustement de Bonferroni). Si initialement $\\alpha = 0.05$ et qu'il y a 10 corrélations qui sont examinées, alors $\\alpha'= 0.005$.\nDonc, afin de rejeter l’hypothèse nulle, la valeur de p devra être plus petite que $\\alpha'$, en l'occurrence 0.005.\nDans l’exemple qui précède, on devrait donc ajuster $\\alpha$ critique en divisant par le nombre total de corrélations dans la matrice (6 dans ce cas, donc $\\alpha'=0.00833$).\nCette correction modifie-t-elle votre conclusion quant à la corrélation entre `lkfl` et `rdwght`?\n\n## Corrélations non paramétriques: *r* de Spearman et $\\tau$ de Kendall\nL'analyse faite à la section précédente avec les esturgeons suggère que l'une des conditions préalables à l'analyse de corrélation, soit la distribution normale bidimensionnelle de données, pourrait ne pas être remplie pour `fklngth` et `rdwght`, ni pour les paires de variables transformées.\nLa recherche d'une transformation appropriée peut parfois être difficile.\nPire encore, pour certaines distributions il n'existe pas de transformation qui va normaliser les données.\nDans ces cas-là, la meilleure option est de faire une analyse non\nparamétrique qui ne présume ni de la normalité ni de la linéarité.\nCes analyses sont basées sur les rangs.\nLes deux plus communes sont le coefficient de rang de Spearman et le $\\tau$ (tau) de Kendall.\n\n- Dans R, testez la corrélation entre `fklngth` et `rdwght` en utilisant Spearman et Kendall’s .\n\n\n```{r}\n#| label: sturcor-spear\ncor.test(\n  sturgeon$lfklngth, sturgeon$rdwght,\n  alternative = \"two.sided\",\n  method = \"spearman\"\n)\n```\n\n```{r}\n#| label: sturcor-ken\ncor.test(\n  sturgeon$lfklngth, sturgeon$rdwght,\n  alternative = \"two.sided\",\n  method = \"kendall\"\n)\n```\n\nComparer les résultats de cette analyse à l'analyse paramétrique.\nPourquoi y-a-t'il une différence ?\n\nCalculez les corrélations non paramétriques sur les paires de variables transformées.\nVous devriez voir tout de suite que les corrélations des données transformées et non transformées sont identiques puisque dans les deux cas la corrélation est calculée à partir des rangs qui ne sont pas affectés par la transformation.\n\nNotez que les corrélations obtenues avec le tau de Kendall (0.820) sont plus faibles que celles du coefficient de Spearman (0.952).\nLe tau de Kendall pondère un peu plus les grandes différences entre les rangs alors que le coefficient de Spearman donne le même poids à chaque paire d’observations.\nEn général, on préfère le tau de Kendall lorsqu’il y a plus d’incertitude quant aux rangs qui sont près les uns des autres.\n\nLes esturgeons de cet échantillon ont été capturés à l'aide de filets et d'hameçons d'une taille fixe.\nQuel impact cette méthode de capture peut-elle avoir eu sur la forme de la distribution de `fklngth` et `rdwght`?\nCompte tenu de ces circonstances, l'analyse de corrélation est-elle appropriée ?\n\nRappelez-vous que l’analyse de corrélation présume aussi que chaque variable est échantillonnée aléatoirement.\nDans le cas de nos esturgeons, ce n’est pas le cas: les hameçons appâtés et les filets ne capturent pas de petits esturgeons (et c’est pourquoi il n’y en a pas dans l’échantillon).\nIl faut donc réaliser que les coefficients de corrélation obtenus dans cette analyse ne reflètent pas nécessairement ceux de la population totale des esturgeons.\n\n## Régression linéaire simple\n\nL'analyse de corrélation vise à décrire comment deux variables covarient.\nL'analyse de régression vise plutôt à produire un modèle permettant de prédire une variable (la variable dépendante) par l'autre (la variable indépendante).\n\nComme pour l'analyse de corrélation, on devrait commencer en examinant des graphiques.\nPuisque l'on est intéressé à quantifier la relation entre deux variables, un graphique de la variable dépendante (Y) en fonction de la variable indépendante (X) est tout à fait approprié.\n\n- Le fichier `sturgeon.csv` contient des données d'un inventaire des esturgeons récoltés en 1978-1980 à Cumberland House en Saskatchewan et à The Pas au Manitoba.\nFaites un diagramme de dispersion de `fklngth` (la variable dépendante) en fonction de `age` (la variable indépendante) pour les esturgeons mâles unqiuement et ajoutez-y une régression linéaire et une trace lowess.\nQue concluez-vous de ce diagramme de dispersion ?\n\n```{r}\n#| label: sturlm-1\n#| warning: false\n#| message: false\nsturgeon.male <- subset(sturgeon, subset = sex == \"MALE\")\nmygraph <- ggplot(\n  data = sturgeon.male, # source of data\n  aes(x = age, y = fklngth)\n) # aesthetics: y=fklngth, x=rdwght\n# plot data points, regression, loess trace\nmygraph <- mygraph +\n  stat_smooth(method = lm, se = FALSE, color = \"green\") + # add linear regression, but no SE shading\n  stat_smooth(color = \"red\") + # add loess\n  geom_point() # add data points\nmygraph # display graph\n```\n\nCe graphique suggère que la relation n’est pas linéaire.\n\nSupposons que nous désirions estimer le taux de croissance des esturgeons mâles.\nUn estimé (peut-être pas terrible...) du taux de croissance peut être obtenu en calculant la pente de la régression de la longueur à la fourche sur l'âge.\n\nAjustons d’abord une régression avec la commande lm() et sauvons ces résultats dans un objet appelé `RegModel.1`.\n\n```{r}\n#| label: sturlm-2\nRegModel.1 <- lm(fklngth ~ age, data = sturgeon.male)\n```\n\nRien n’apparait à l’écran, c'est normal ne vous inquiétez pas, tout a été sauvegardé en mémoire.\nPour voir les résultats, tapez:\n\n```{r}\n#| label: sturlm-3\nsummary(RegModel.1)\n```\n\nla sortie R donne:\n\n1. `Call:` Le modèle qui a été ajusté et les données utilisées.\n2. `Residuals:` Un sommaire statistique des résidus autour du modèle estimé.\n3. `Coefficients:` Valeurs estimées des paramètres du modèle, erreurs-types, statistiques t et probabilités associées.\n4. `Residual standard error:` Racine carrée de la variance résiduelle.\n5. `Multiple R-squared:` Coefficient de détermination. Il correspond à la proportion de la variabilité de la variable dépendante qui peut être expliquée par la régression.\n6. `Adjusted R-squared:` Le R-carré ajusté tient compte du nombre de paramètres du modèle. Si vous voulez comparer différents modèles qui n’ont pas le même nombre de paramètres, c’est ce qu’il faut utiliser.\n7. `F-statistic:` C’est le test de signification omnibus du modèle. Dans le cas de la régression simple, il est équivalent au test sur la pente de la régression.\n\n\nLa régression estimée est donc:\n\n$$ Fklngth = 28.50359 + 0.70724 * age$$\n\nÉtant donné la valeur significative du test de F ainsi que pour le test de t pour la pente de la droite, on rejette l’hypothèse nulle qu’il n’y a pas de relation entre la taille et l’âge.\n\n### Vérifier les conditions d'application de la régression\n\nLa régression simple de type I a quatre conditions préalables :\n\n1. il n'y a pas d'erreur de mesure sur la variable indépendante (X)\n2. la relation entre Y et X est linéaire\n3. les résidus sont normalement distribués\n4. la variance des résidus est constante pour toutes les valeurs de la variable indépendante\n\nProcédons maintenant à l'examen post-mortem. La première\ncondition est rarement remplie avec des données biologiques ; il y\npresque toujours de l'erreur sur X et sur Y. Cela veut dire qu'en\ngénéral les pentes estimées sont biaisées, mais que les valeurs prédites\nne le sont pas. Toutefois, si l'erreur de mesure sur X est petite par\nrapport à l'étendue des valeurs de X, le résultat de l'analyse n'est pas\ndramatiquement influencé. Par contre, si l'erreur de mesure est\nrelativement grande (toujours par rapport à l'étendue des valeurs de\nX), la droite de régression obtenue par la régression de modèle I est\nun piètre estimé de la relation fonctionnelle entre X et Y. Dans ce cas,\nil est préférable de passer à la régression de modèle II,\nmalheureusement au-delà du contenu de ce cours.\nLes autres conditions préalables à l'analyse de régression de modèle I\npeuvent cependant être vérifiées, ou du moins évaluées visuellement.\nLa commande plot() permet de visualiser des graphiques\ndiagnostiques pour des modèles linéaires.\n\n```{r}\n#| label: sturlmv-1\n#| eval: false\npar(mfrow = c(2, 2), las = 1)\nplot(RegModel.1)\n```\n\nLa commande par() est utilisée pour dire à R de tracer 2 rangées et 2 colonnes de graphiques par page (il y a quatre graphiques diagnostiques qui sont générés automatiquement pour les modèles linéaires), et la commande las indique à R d’effectuer une rotation des légendes de l’axe des Y pour qu’elles soient perpendiculaires à l’axe (oui. Je sais. Rien de tout ça n’est évident.)\n\nVous obtiendrez:\n```{r}\n#| label: sturlmv-1eval\n#| echo: false\npar(mfrow = c(2, 2), las = 1)\nplot(RegModel.1)\n```\n\n1. En haut à gauche, permet d’évaluer la linéarité, la normalité, et l’homoscédasticité des résidus. Il illustre les déviations autour de la régression en fonction des valeurs prédites. Rappllez-vous que le graphique de fklngth vs age suggère que la relation entre la longueur à la fourche et l’âge n’est pas linéaire. Les très jeunes et très vieux esturgeons sont sous la droite en général, alors que les esturgeons d’âge moyen sont retrouvés généralement au-dessus de la droite de régression. C’est exactement ce que le graphique des résidus en fonction des valeurs prédites illustre. La ligne en rouge est une   trace lowess au travers de ce nuage de points. Si la relation était linéaire, la trace lowess serait presque plate et près de 0. La dispersion des résidus permet d’évaluer visuellement leur normalité et hétéroscédasticité; mais ce graphique n’est pas optimal pour évaluer ces propriétés. Les deux graphiques suivants sont supérieurs au premier pour cela.\n2. En haut à droite permet d’évaluer la normalité des résidus. C’est un graphique QQ des résidus (QQ plot). Des résidus distribués normalement tomberaient exactement sur la diagonale. Ici, on voit que c’est presque le cas, sauf dans les queues de la distribution.\n3. En bas à gauche, intitulé Scale-Location, permet d’évaluer l’homoscedasticité. On y retrouve sur l’ordonnée (l’axe des y) la racine carrée de la valeur absolue des résidus standardisés (résidus divisés par l’écart-type des résidus) en fonction des valeurs prédites. Le graphique aide à déterminer si la variation des résidus est constante ou non. Si les résidus sont homoscédastiques, la valeur moyenne sur l’axe des y ne va pas changer en fonction de la valeur prédite. Ici, il y a une certaine tendance, mais pas une tendance monotone puisqu’ il y a d’abord une baisse puis une hausse..; bref, rien qui soit une forte évidence contre la supposition d’homoscédasticité.\n4. En bas à droite, montre les résidus en fonction du \"leverage\" et permet de détecter certaines valeurs extrêmes qui ont une grande influence sur la régression. Le leverage d’un point mesure sa distance des autres points, mais seulement en ce qui concerne les variables indépendantes. Dans le cas d’une régression simple, cela revient à la distance entre le point sur l’axe des x et la moyenne de tous les points sur cet axe. Vous devriez porter une attention particulière aux observations qui ont un leverage plus grand que $2(k+1)/n$, où k est le nombre de variables indépendantes (ici, 1) et n est le nombre d’observations. Dans cet exemple, il y a 75 observations et une variable indépendante et donc les points ayant un leverage plus grand que $4 / 75 =  0.053$ devrait être considérés avec attention. Le graphique indique également comment la régression changerait si on enlevait un point. Ce changement est mesuré par la distance de Cook, illustrée par les bandes en rouge sur le graphique. Un point ayant une distance de Cook supérieure à 1 a une grande influence.\n\n::: {.callout-warning}\nNotez que R identifie automatiquement les cas les plus extrèmes sur chacun de ces 4 graphiques. Le fait qu’un point soit identifié ne signifie pas nécessairement que c’est une valeur réellement extrème, ou que vous devez vous en préoccuper. Dans tous les ensembles de données il y aura toujours un résidu plus grand que les autres...\n:::\n\nIl est possible d'obtenir des graphiques d'évalutions des conditions d'applications, qui sont plus simple à interpréter et plus joli (avec des couleurs).\nIl faut utiliser la fonction `model_check()` dans le `r emoji::emoji(\"package\")` `performance`.\n\n```{r}\ncheck_model(RegModel.1)\n```\nFinalement, quel est le verdict concernant la régression linéaire entre fklngth et age ? Elle viole la condition de linéarité, possiblement celle de normalité, remplit la condition d’homoscédasticité, et ne semble pas influencée outre mesure par des valeurs bizarres ou extrêmes.\n\n\n### Tests formels des conditions d’application pour la régression\n\nPersonnellement, je n’utilise jamais les tests formels des conditions d’application de la régression et me contente des graphiques des résidus pour guider mes décisions. C’est ce que la plupart des praticiens font. Cependant, lors de mes premières analyses, je n’étais pas toujours certain de bien interpréter les graphiques et j’aurais aimé un indice plus formel ou un test permettant de détecter les violations des conditions d’application de la régression.\n\nLe package `lmtest`, qui ne fait pas partie de l’installation de base, mais qui est disponible sur CRAN, permet de faire plusieurs tests de linéarité et d’homoscédasticité. Et on peut tester la normalité avec le test Shapiro-Wilk test vu précédemment.\n\n\nCharger le package lmtest de CRAN (et installer le si besoin).\n\n::: {.callout-tip collapse=\"true\"}\n# Solution\n```{r}\n#| label: sturfor-1\nlibrary(lmtest)\n```\n:::\n\n::: {.callout-caution}\n# Exercice\nExécutez les commandes suivantes\n:::\n\n```{r}\n#| label: sturfor-2\nbptest(RegModel.1)\n```\n\nLe test Breusch-Pagan test examine si la variabilité des résidus est constantes lorsque les valeurs prédites changent. Une faible valeur de p suggère de l’hétéroscédasticité. Ici, la valeur p est élevée et suggère que la condition d’application d’homoscédasticité est remplie avec ces données.\n\n```{r}\n#| label: sturfor-3\ndwtest(RegModel.1)\n```\n\nLe test Durbin-Watson permet de détecter l’autocorrélation sérielle des résidus. En l’absence d’autocorrélation (i.e. d’indépendance des résidus) la valeur attendue de la statistique D est 2. Ce test permet d’éprouver l’hypothèse d’indépendance des résidus, mais ne permet de détecter qu’un type particulier de dépendance. Ici, le test ne permet pas de rejeter l’hypothèse d’indépendance.\n\n```{r}\n#| label: sturfor-4\nresettest(RegModel.1)\n```\n\nLe test RESET permet d’éprouver la linéarité. Si la relation est linéaire, alors la statistique RESET sera d’environ 1. Ici, la statistique est beaucoup plus élevée (14.54) et hautement significative. Le test confirme la tendance que nous avons détectée visuellement plus haut: la relation n’est pas linéaire.\n\n```{r}\n#| label: sturfor-5\nshapiro.test(residuals(RegModel.1))\n```\n\nLe test de normalité Shapiro-Wilk sur les résidus confirme que la déviation par rapport à une distribution normale des résidus n’est pas grande.\n\n## Transformation des données en régression\nLa relation entre `fklngth` et `age` n’étant pas linéaire, on devrait donc essayer de transformer les données pour tenter de les linéariser :\n\n- Voyons ce qu’une transformation log donne:\n\n```{r}\n#| label: sturtr-1\n#| warning: false\n#| message: false\npar(mfrow = c(1, 1), las = 1)\nggplot(\n  data = sturgeon.male,\n  aes(x = log10(age), y = log10(fklngth))\n) +\n  geom_smooth(color = \"red\") +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"green\") +\n  geom_point()\n```\n\nAjustons maintenant une régression simple sur ces données transformées.\n\n```{r}\n#| label: sturtr-2\nRegModel.2 <- lm(log10(fklngth) ~ log10(age), data = sturgeon.male)\nsummary(RegModel.2)\n```\n\nExaminons maintenant les graphiques diagnostiques:\n\n```{r}\n#| label: sturtr-3\npar(mfrow = c(2, 2), las = 1)\nplot(RegModel.2)\n```\n\nIl y a une certaine amélioration, mais ce n’est pas encore parfait (la perfection n’est pas de ce monde....). Le graphique des résidus en fonction des valeurs prédites suggère encore une certaine non linéarité. Sur le graphique Q-Q les points se retrouvent plus près de la droite diagonale qu’avant, indiquant que les résidus sont encore plus près de la normalité après la transformation log-log. Il n’y a pas d’indice d’hétéroscédasticité. Finalement, même si il reste quelques points avec plus d’influence (leverage) que les autres, aucun n’a une distance de Cook au-delà de 0.5. En résumé, la transformation log a amélioré les choses: relation est plus linéaire, les résidus sont plus normaux, et il y a moins de points avec une influence relativement élevée.Est-ce que les tests formels supportent cette évaluation?\n\n```{r}\n#| label: sturtr-4\nbptest(RegModel.2)\ndwtest(RegModel.2)\nresettest(RegModel.2)\nshapiro.test(residuals(RegModel.2))\n```\n\nOui, les conclusions sont les mêmes: les résidus sont encore homoscédastiques (test Breusch-Pagan), ne sont pas autocorrélés (test Durbin-Watson), sont normaux (test Shapiro-Wilk), et sont plus linéaires (la valeur de P du test RESET est maintenant 0.015, au lieu de 0.000005). Donc la linéarité a augmenté, mais cette condition d’application semble encore légèrement violée.\n\n## Traitement des valeurs extrèmes\nDans cet exemple, il n’y a pas de valeur vraiment extrème. Oui, je sais, R a quand même identifié les observations 8, 24, et 112 dans le dernier graphique diagnostique. Mais ces valeurs sont encore dans la fourchette de valeurs que je juge \"acceptables\". Mais comment déterminer objectivement ce qui est acceptable? À quel moment juge t’on qu’une valeur extrême est vraiment trop invraisemblable pour ne pas l’exclure? Il n’y a malheureusement pas de règle absolue là-dessus. Les opinions varient, mais je penche vers le conservatisme sur cette question.\n\nMa position est que, à moins que la valeur soit biologiquement impossible ou clairement une erreur d’entrée de données, je n’élimine pas les valeurs extrêmes et j’utilise toutes mes données dans leur analyse. Pourquoi?\n\nParce que je veux que mes données reflètent bien la variabilité naturelle ou réelle. C’est d’ailleurs parfois cette variabilité qui est intéressante.\n\nL’approche conservatrice qui consiste à conserver toutes les valeurs extrêmes possibles est possiblement la plus honnête, mais elle peut causer certains problèmes. Ces valeurs extrêmes sont souvent la cause des violations des conditions d’application des tests statistiques. La solution suggérée à ce dilemme est de faire l’analyse avec et sans les valeurs extrêmes et de comparer les conclusions. Dans bien des cas, les conclusions seront qualitativement les mêmes et les tailles d’effet ne seront pas très différentes. Toutefois, dans certains cas, la présence des valeurs extrêmes change complètement les conclusions. Dans ces cas, il faut simplement accepter que les conclusions dépendent entièrement de la présence des valeurs extrêmes et sont donc peu concluantes.\n\nSuivant cette approche comparative, refaisons donc l’analyse après\navoir enlevé les observations 8, 24, et 112.\n\n```{r}\n#| label: sturtr-5\nRegModel.3 <- lm(log10(fklngth) ~ log10(age), data = sturgeon.male, subset = !(rownames(sturgeon.male) %in% c(\"8\", \"24\", \"112\")))\nsummary(RegModel.3)\n```\n\n\nL’ordonnée à l’origine (Intercept), la pente, et le R carré sont presque les mêmes, et la valeur de p est encore astronomiquement petite. Enlever les valeurs extrêmes a peu d’effet dans ce cas.\n\nLes graphiques diagnostiques des résidus et les tests formels des conditions d’application sur ce sous-ensemble de données donnent:\n\n```{r}\n#| label: sturtr-6\npar(mfrow = c(2, 2))\nplot(RegModel.3)\nsturgeon.male.subset <- subset(sturgeon, subset = !(rownames(sturgeon.male) %in% c(\"8\", \"24\", \"112\")))\nbptest(RegModel.3)\ndwtest(RegModel.3)\nresettest(RegModel.3)\nshapiro.test(residuals(RegModel.3))\n```\n\nIl n’y a pas vraiment de différence ici non plus avec l’analyse des données en entier. Bref, tout pointe vers la conclusion que les valeurs les plus extrêmes de cet ensemble de donnée n’influencent pas indûment les résultats statistiques.\n\n## Quantifier la taille d’effet et analyse de puissance en régression\n\nL’interprétation biologique des résultats n’est pas la même chose que l’interprétation statistique. Dans l’analyse qui précède, on conclue statistiquement que la taille augmente avec l’âge (puisque la pente est positive et et p<0.05). Mais cette augmentation \"statistique\" de la taille avec l’âge ne donne pas d’information sur la différence de taille entre les jeunes et vieux individus. La pente et un graphique sont plus informatifs à ce sujet que la valeur p. La pente (dans l’espace log-log) est 0.34. Cela veut dire que pour chaque unité d’accroissement de X (log10(age)), il y a une augmentation de 0.34 unités de log10(fklngth). En d’autres mots, quand l’âge est multiplié par 10, la longueur à la fourche est multipliée environ par 2 (10^0.34^). Donc la longueur des esturgeons augmente plus lentement que leur âge (contrairement à mon tour de taille, semble-t-il....). La valeur de la pente (0.34) est un estimé de la taille de l’effet de l’âge sur la longueur.\n\nIl est aussi importnat d'estimer l'intervalle de confiance sur la pente pour pouvoir estimer si l'intervalle inclus ou non que des valeurs biologiquement importantes. Cela peut être fait simplement avec la fonction `confint()`.\n\n```{r}\n#| label: ci-es-lm\nconfint(RegModel.2)\n```\n\nL'intervalle de confiance à 95% de la pente est 0.29-0.38. L,intervalle de confiance est assez faible et éloigné de zéro.\n\n### Puissance de détecter une pente donnée\nPour les calculs de puissance avec G\\*Power vous devrez cependant utiliser une autre métrique de la taille de l’effet, calculée à partir de la pente, de son erreur-type, et de la taille de l’échantillon (ce qui facilite les calculs pour G*Power, mais malheureusement pas pour vous ;-) La métrique (d) est calculée comme:\n$$ d = \\frac{b}{s_b\\sqrt{n-k-1}} $$\noù $b$ est l’estimé de la pente, $s_b$ est l’erreur type de la pente, $n$ est le nombre d’observations, et $k$ est le nombre de variables indépendantes (1 pour la régression linéaire simple).\n\nVous pouvez calculer approximativement la puissance avec G\\*Power pour une valeur de pente que vous jugez assez grande pour mériter d’être détectée. Allez à __Tests: Means: One group: difference from constant__, là, vous devrez remplacer la valeur de $b$ dans l’équation pour la taille d’effet (d) par la pente que vous voudriez détecter, mais utiliser l’erreur type calculée à partir de vos données.\n\nPar exemple, supposons que les ichthyologues considèrent qu’une pente de 0.1 pour la relation entre log10(fklngth) et log10(age) est signifiante biologiquement, et qu’ils désirent estimer la puissance de détecter une telle pente à partir d’un échantillon de 20 esturgeons. Les résultats de la régression log-log nous fournissent ce dont on a besoin:\n\n```{r}\n#| label: sturpow-1\nsummary(RegModel.2)\n```\n\nL’erreur-type de la pente est 0.02168. Il y avait 75 poissons (n=75) dans l’échantillon de départ. On peut donc calculer la métrique de taille d’effet pour G\\*Power\n$$ d = \\frac{b}{s_b\\sqrt{n-k-1}} = \\frac{0.1}{0.02168\\sqrt{74-1-1}}=0.54$$\n\nArmés de cette taille d’effet (une pente présumée de 0.1 et une variabilité autour de la régression similaire à la régression de fklngth vs age), aller à __Tests: Means: One group: difference from constant__, et entrez la valeur calculée de d, alpha, et l’effectif de l’échantillon pour calculer la puissance.\n\n```{r  }\n#| label: lm-pow-fig-1\n#| echo: false\n#| fig-cap: Analyse de puissance pour N = 20 et pente = 0.1\n#| out-width: 100%\nknitr::include_graphics(\"images/lm_pow_1.png\")\n```\n\nDans R, il est possible de faire cette analyse avec le code suivant:\n\n```{r}\n#| label: rlm_r-pow-1\nlibrary(pwr)\n\n# analyse de puissance\npwr.t.test(n = 20, d = 0.54, sig.level = 0.05, type = \"one.sample\")\n```\n\nLa puissance de détecter une pente comme étant statistiquement significative (au niveau alpha), si la pente est 0.1, que la variabilité résiduelle autour de la régression est semblable à celle de notre échantillon (ce qui revient à une taille d’effet de 0.54, pour un échantillon de 20 esturgeons et alpha=0.05) est de 0.629. Seulement environ 2/3 des échantillons de cette taille détecteraient un effet significatif de l’âge sur `fklngth`.\n\n### Effectif requis pour atteindre une puissance désirée (test A-priori)\nPour estimer la taille d’échantillon (effectif) requis pour avoir une puissance de 99% de détecter un effet de l’âge si la pente est 0.1 (sur une échelle log-log), avec alpha=0.05, on utilise la même valeur de d (0.54):\n\n```{r  }\n#| label: lm-pow-fig-2\n#| echo: false\n#| fig-cap: Analyse à priori pour déterminer la taille d'échantillon pour une puissance\n#|   de 0.99\n#| out-width: 100%\nknitr::include_graphics(\"images/lm_pow_2.png\")\n```\n\nDans R, il est possible de faire cette analyse avec le code suivant:\n\n```{r}\n#| label: lm_r-pow-1\nlibrary(pwr)\n\n# analyse de puissance\npwr.t.test(n = 65, d = 0.54, sig.level = 0.05, type = \"one.sample\")\n```\n\nEn augmentant la taille de l’échantillon à 65, selon le même scénario que précédemment, la puissance augmente à 99%.\n\n\n## Bootstrap en régression simple avec R\n\nUn test non paramétrique pour l’ordonnée à l’origine et la pente d’une régression simple peut être effectué par bootstrap.\n\n```{r}\n#| label: lm-boot-1\n# charger le paquet boot\nlibrary(boot)\n# obtenir les poids de régression\nbs <- function(formula, data, indices) {\n  d <- data[indices, ] # allows boot to select sample\n  fit <- lm(formula, data = d)\n  return(coef(fit))\n}\n# bootstrapping with 1000 replications\nresults <- boot(\n  data = sturgeon.male,\n  statistic = bs,\n  R = 1000, formula = log10(fklngth) ~ log10(age)\n)\n# view results\nresults\n```\n\nPour chaque paramètre du modèle (ici l’ordonnée à l’origine est\nappelée t1\\* et la pente de la régression t2\\*), R imprime :\n\n1. `original` la valeur estimée sur tout l’échantillon\n2. `bias` la différence entre la valeur moyenne des estimés par bootstrap et la valeur originale sur tout l’échantillon\n3. `std. error` l’erreur-type de l’estimé bootstrap\n\n```{r}\n#| label: lm-boot-2\npar(mfrow = c(2, 2))\nplot(results, index = 1) # intercept\nplot(results, index = 2) # log10(age)\n```\n\n\nLa distribution des estimés obtenus par bootstrap est assez normale dans cet exemple, avec de petites déviations dans les queuee de la distribution (là où ça compte pour les intervalles de confiance...). On pourrait utiliser l’erreur-type des estimés bootstrap pour calculer un intervalle de confiance symétrique (moyenne +- t ET). Cependant, comme R peut facilement calculer des intervalles de confiance qui corrigent pour le biais (BCa) ou encore des intervalle empiriques à partir des distributions simulées (méthode Percentile) il peut être aussi simple de les calculer selon les 3 méthodes:\n\n```{r}\n#| label: lm-boot-3\n# interval de confiance pour l'ordonnée à l'origine\nboot.ci(results, type = \"all\", index = 1)\n```\n```{r}\n#| label: lm-boot-4\n# intervalle de confiance pour la pente\nboot.ci(results, type = \"all\", index = 2)\n```\n\nIci, les 4 types d’intervalles de confiance que R a calculé sont essentiellement semblables. Si les données avaient violé plus sévèrement les conditions d’application de la régression (normalité, homoscedasticité), alors les différentes méthodes (Normal, Basic, Percentile, et BCa) auraient divergé un peu plus. Lequel choisir alors? BCa est celui qui est préféré de la majorité des praticiens, présentement.\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","from":"markdown+emoji","number-sections":true,"output-file":"31-reg_lin.html"},"language":{"toc-title-document":"Table des matières","toc-title-website":"Sur cette page","related-formats-title":"Autres formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"La source","other-links-title":"Autres liens","code-links-title":"Liens de code","launch-dev-container-title":"Lancer le Dev Container","launch-binder-title":"Lancer le Binder","article-notebook-label":"Cahier d'articles","notebook-preview-download":"Télécharger le cahier","notebook-preview-download-src":"Télécharger le code source","notebook-preview-back":"Retour à l'article","manuscript-meca-bundle":"Archive MECA","section-title-abstract":"Résumé","section-title-appendices":"Annexes","section-title-footnotes":"Notes de bas de page","section-title-references":"Les références","section-title-reuse":"Réutilisation","section-title-copyright":"Droits d'auteur","section-title-citation":"Citation","appendix-attribution-cite-as":"Veuillez citer ce travail comme suit :","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Voir la Licence","title-block-author-single":"Auteur·rice","title-block-author-plural":"Auteur·rice·s","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Date de publication","title-block-modified":"Modifié","title-block-keywords":"Mots clés","callout-tip-title":"Astuce","callout-note-title":"Note","callout-warning-title":"Avertissement","callout-important-title":"Important","callout-caution-title":"Mise en garde","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Montrer tout le code","code-tools-hide-all-code":"Cacher tout le code","code-tools-view-source":"Voir les sources","code-tools-source-code":"Code source","tools-share":"Share","tools-download":"Télécharger","code-line":"Ligne","code-lines":"Lignes","copy-button-tooltip":"Copier vers le presse-papier","copy-button-tooltip-success":"Copié","repo-action-links-edit":"Modifier cette page","repo-action-links-source":"Voir la source","repo-action-links-issue":"Faire part d'un problème","back-to-top":"Retour au sommet","search-no-results-text":"Pas de résultats","search-matching-documents-text":"documents trouvés","search-copy-link-title":"Copier le lien vers la recherche","search-hide-matches-text":"Cacher les correspondances additionnelles","search-more-match-text":"correspondance de plus dans ce document","search-more-matches-text":"correspondances de plus dans ce document","search-clear-button-title":"Effacer","search-text-placeholder":"","search-detached-cancel-button-title":"Annuler","search-submit-button-title":"Envoyer","search-label":"Recherche","toggle-section":"Basculer la section","toggle-sidebar":"Basculer la barre latérale","toggle-dark-mode":"Basculer le mode sombre","toggle-reader-mode":"Basculer en mode lecteur","toggle-navigation":"Basculer la navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Théorème","crossref-lem-title":"Lemme","crossref-cor-title":"Corollaire","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Définition","crossref-exm-title":"Exemple","crossref-exr-title":"Exercice","crossref-ch-prefix":"Chapitre","crossref-apx-prefix":"Annexe","crossref-sec-prefix":"Section","crossref-eq-prefix":"Équation","crossref-lof-title":"Liste des Figures","crossref-lot-title":"Liste des Tables","crossref-lol-title":"Liste des Listings","environment-proof-title":"Preuve","environment-remark-title":"Remarque","environment-solution-title":"Solution","listing-page-order-by":"Trier par","listing-page-order-by-default":"Ordre par défaut","listing-page-order-by-date-asc":"Le plus ancien","listing-page-order-by-date-desc":"Le plus récent","listing-page-order-by-number-desc":"Descendant","listing-page-order-by-number-asc":"Ascendant","listing-page-field-date":"Date","listing-page-field-title":"Titre","listing-page-field-description":"Description","listing-page-field-author":"Auteur·rice","listing-page-field-filename":"Nom de fichier","listing-page-field-filemodified":"Modifié","listing-page-field-subtitle":"Sous-titre","listing-page-field-readingtime":"Temps de lecture","listing-page-field-wordcount":"Compteur de Mots","listing-page-field-categories":"Catégories","listing-page-minutes-compact":"{0} min.","listing-page-category-all":"Tous","listing-page-no-matches":"Aucun article correspondant","listing-page-words":"{0} mots","listing-page-filter":"Filtre","draft":"Brouillon"},"metadata":{"lang":"fr-fr","fig-responsive":true,"quarto-version":"1.5.45","version":"0.6.0","year":2024,"bibliography":["biblio/book.bib","biblio/grateful-refs.bib"],"biblio-style":"apalike","csl":"biblio/ecology.csl","params":{"echo_sol":true,"longrun":false,"html_pdf":true},"cit-title":"Faites ce que vous pensez être intéressant,  \nfaites quelque chose que vous pensez être utile et amusant,  \nparce que sinon, vous ne le ferez pas bien de toute façon.\n","cit-author":"Brian W. Kernighan","theme":{"light":"cosmo","dark":["cosmo","css/theme-dark.scss"]},"author-meta":"Julien Martin"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"lualatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","from":"markdown+emoji","number-sections":true,"output-file":"31-reg_lin.pdf"},"language":{"toc-title-document":"Table des matières","toc-title-website":"Sur cette page","related-formats-title":"Autres formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"La source","other-links-title":"Autres liens","code-links-title":"Liens de code","launch-dev-container-title":"Lancer le Dev Container","launch-binder-title":"Lancer le Binder","article-notebook-label":"Cahier d'articles","notebook-preview-download":"Télécharger le cahier","notebook-preview-download-src":"Télécharger le code source","notebook-preview-back":"Retour à l'article","manuscript-meca-bundle":"Archive MECA","section-title-abstract":"Résumé","section-title-appendices":"Annexes","section-title-footnotes":"Notes de bas de page","section-title-references":"Les références","section-title-reuse":"Réutilisation","section-title-copyright":"Droits d'auteur","section-title-citation":"Citation","appendix-attribution-cite-as":"Veuillez citer ce travail comme suit :","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Voir la Licence","title-block-author-single":"Auteur·rice","title-block-author-plural":"Auteur·rice·s","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Date de publication","title-block-modified":"Modifié","title-block-keywords":"Mots clés","callout-tip-title":"Astuce","callout-note-title":"Note","callout-warning-title":"Avertissement","callout-important-title":"Important","callout-caution-title":"Mise en garde","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Montrer tout le code","code-tools-hide-all-code":"Cacher tout le code","code-tools-view-source":"Voir les sources","code-tools-source-code":"Code source","tools-share":"Share","tools-download":"Télécharger","code-line":"Ligne","code-lines":"Lignes","copy-button-tooltip":"Copier vers le presse-papier","copy-button-tooltip-success":"Copié","repo-action-links-edit":"Modifier cette page","repo-action-links-source":"Voir la source","repo-action-links-issue":"Faire part d'un problème","back-to-top":"Retour au sommet","search-no-results-text":"Pas de résultats","search-matching-documents-text":"documents trouvés","search-copy-link-title":"Copier le lien vers la recherche","search-hide-matches-text":"Cacher les correspondances additionnelles","search-more-match-text":"correspondance de plus dans ce document","search-more-matches-text":"correspondances de plus dans ce document","search-clear-button-title":"Effacer","search-text-placeholder":"","search-detached-cancel-button-title":"Annuler","search-submit-button-title":"Envoyer","search-label":"Recherche","toggle-section":"Basculer la section","toggle-sidebar":"Basculer la barre latérale","toggle-dark-mode":"Basculer le mode sombre","toggle-reader-mode":"Basculer en mode lecteur","toggle-navigation":"Basculer la navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Théorème","crossref-lem-title":"Lemme","crossref-cor-title":"Corollaire","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Définition","crossref-exm-title":"Exemple","crossref-exr-title":"Exercice","crossref-ch-prefix":"Chapitre","crossref-apx-prefix":"Annexe","crossref-sec-prefix":"Section","crossref-eq-prefix":"Équation","crossref-lof-title":"Liste des Figures","crossref-lot-title":"Liste des Tables","crossref-lol-title":"Liste des Listings","environment-proof-title":"Preuve","environment-remark-title":"Remarque","environment-solution-title":"Solution","listing-page-order-by":"Trier par","listing-page-order-by-default":"Ordre par défaut","listing-page-order-by-date-asc":"Le plus ancien","listing-page-order-by-date-desc":"Le plus récent","listing-page-order-by-number-desc":"Descendant","listing-page-order-by-number-asc":"Ascendant","listing-page-field-date":"Date","listing-page-field-title":"Titre","listing-page-field-description":"Description","listing-page-field-author":"Auteur·rice","listing-page-field-filename":"Nom de fichier","listing-page-field-filemodified":"Modifié","listing-page-field-subtitle":"Sous-titre","listing-page-field-readingtime":"Temps de lecture","listing-page-field-wordcount":"Compteur de Mots","listing-page-field-categories":"Catégories","listing-page-minutes-compact":"{0} min.","listing-page-category-all":"Tous","listing-page-no-matches":"Aucun article correspondant","listing-page-words":"{0} mots","listing-page-filter":"Filtre","draft":"Brouillon"},"metadata":{"block-headings":false,"version":"0.6.0","year":2024,"bibliography":["biblio/book.bib","biblio/grateful-refs.bib"],"biblio-style":"apalike","csl":"biblio/ecology.csl","params":{"echo_sol":true,"longrun":false,"html_pdf":true},"lang":"fr-fr","cit-title":"Faites ce que vous pensez être intéressant,  \nfaites quelque chose que vous pensez être utile et amusant,  \nparce que sinon, vous ne le ferez pas bien de toute façon.\n","cit-author":"Brian W. Kernighan","documentclass":"scrreprt","classoption":["chapterprefix=true","headings=big","twoside=semi"],"papersize":"letter","fontsize":"11pt","geometry":["top=2cm","bottom=2cm","left=2cm","right=2cm","footskip=1cm"],"colorlinks":true,"linestretch":1.5,"template-partials":["latex/before-title.tex","latex/before-body.tex"]},"extensions":{"book":{"selfContainedOutput":true}}},"epub":{"identifier":{"display-name":"ePub","target-format":"epub","base-format":"epub"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"epub","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":false,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"default-image-extension":"png","html-math-method":"mathml","to":"epub","from":"markdown+emoji","toc":true,"output-file":"31-reg_lin.epub"},"language":{"toc-title-document":"Table des matières","toc-title-website":"Sur cette page","related-formats-title":"Autres formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"La source","other-links-title":"Autres liens","code-links-title":"Liens de code","launch-dev-container-title":"Lancer le Dev Container","launch-binder-title":"Lancer le Binder","article-notebook-label":"Cahier d'articles","notebook-preview-download":"Télécharger le cahier","notebook-preview-download-src":"Télécharger le code source","notebook-preview-back":"Retour à l'article","manuscript-meca-bundle":"Archive MECA","section-title-abstract":"Résumé","section-title-appendices":"Annexes","section-title-footnotes":"Notes de bas de page","section-title-references":"Les références","section-title-reuse":"Réutilisation","section-title-copyright":"Droits d'auteur","section-title-citation":"Citation","appendix-attribution-cite-as":"Veuillez citer ce travail comme suit :","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Voir la Licence","title-block-author-single":"Auteur·rice","title-block-author-plural":"Auteur·rice·s","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Date de publication","title-block-modified":"Modifié","title-block-keywords":"Mots clés","callout-tip-title":"Astuce","callout-note-title":"Note","callout-warning-title":"Avertissement","callout-important-title":"Important","callout-caution-title":"Mise en garde","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Montrer tout le code","code-tools-hide-all-code":"Cacher tout le code","code-tools-view-source":"Voir les sources","code-tools-source-code":"Code source","tools-share":"Share","tools-download":"Télécharger","code-line":"Ligne","code-lines":"Lignes","copy-button-tooltip":"Copier vers le presse-papier","copy-button-tooltip-success":"Copié","repo-action-links-edit":"Modifier cette page","repo-action-links-source":"Voir la source","repo-action-links-issue":"Faire part d'un problème","back-to-top":"Retour au sommet","search-no-results-text":"Pas de résultats","search-matching-documents-text":"documents trouvés","search-copy-link-title":"Copier le lien vers la recherche","search-hide-matches-text":"Cacher les correspondances additionnelles","search-more-match-text":"correspondance de plus dans ce document","search-more-matches-text":"correspondances de plus dans ce document","search-clear-button-title":"Effacer","search-text-placeholder":"","search-detached-cancel-button-title":"Annuler","search-submit-button-title":"Envoyer","search-label":"Recherche","toggle-section":"Basculer la section","toggle-sidebar":"Basculer la barre latérale","toggle-dark-mode":"Basculer le mode sombre","toggle-reader-mode":"Basculer en mode lecteur","toggle-navigation":"Basculer la navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Théorème","crossref-lem-title":"Lemme","crossref-cor-title":"Corollaire","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Définition","crossref-exm-title":"Exemple","crossref-exr-title":"Exercice","crossref-ch-prefix":"Chapitre","crossref-apx-prefix":"Annexe","crossref-sec-prefix":"Section","crossref-eq-prefix":"Équation","crossref-lof-title":"Liste des Figures","crossref-lot-title":"Liste des Tables","crossref-lol-title":"Liste des Listings","environment-proof-title":"Preuve","environment-remark-title":"Remarque","environment-solution-title":"Solution","listing-page-order-by":"Trier par","listing-page-order-by-default":"Ordre par défaut","listing-page-order-by-date-asc":"Le plus ancien","listing-page-order-by-date-desc":"Le plus récent","listing-page-order-by-number-desc":"Descendant","listing-page-order-by-number-asc":"Ascendant","listing-page-field-date":"Date","listing-page-field-title":"Titre","listing-page-field-description":"Description","listing-page-field-author":"Auteur·rice","listing-page-field-filename":"Nom de fichier","listing-page-field-filemodified":"Modifié","listing-page-field-subtitle":"Sous-titre","listing-page-field-readingtime":"Temps de lecture","listing-page-field-wordcount":"Compteur de Mots","listing-page-field-categories":"Catégories","listing-page-minutes-compact":"{0} min.","listing-page-category-all":"Tous","listing-page-no-matches":"Aucun article correspondant","listing-page-words":"{0} mots","listing-page-filter":"Filtre","draft":"Brouillon"},"metadata":{"version":"0.6.0","year":2024,"bibliography":["biblio/book.bib","biblio/grateful-refs.bib"],"biblio-style":"apalike","csl":"biblio/ecology.csl","params":{"echo_sol":true,"longrun":false,"html_pdf":true},"lang":"fr-fr","cit-title":"Faites ce que vous pensez être intéressant,  \nfaites quelque chose que vous pensez être utile et amusant,  \nparce que sinon, vous ne le ferez pas bien de toute façon.\n","cit-author":"Brian W. Kernighan","dev":"svglite","stylesheet":"css/epub.css"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf","epub"]}